<body>
  <div id="app"></div>

</body>

<!-- <script src="https://unpkg.com/vue@3"></script> -->


<script type="module">

  // const {
  //   effect,
  //   ref
  // } = Vue


  // function renderer(doString, contianer) {
  //   contianer.innerHTML = doString
  // }


  // const count = ref(1)
  // effect(() => {
  //   renderer(`<h1>${count.value}</h1>`, document.getElementById('app'))
  // })

  // count.value++

  import { createRenderer, shouldSetAsProps} from "./src/renderer.js"
  const vnode = {
    type: 'div',
    props:{
      id: 'foo'
    },
    children: [
      {
        type: 'p',
        children: 'hello'
      },
      {
        type: 'button', 
        props: {
          disable: ''
        },
        children: 'button'
      }
    ]
  }

  // 创建一个渲染器
  const renderer = createRenderer({
    createElement(tag) {
      return document.createElement(tag)
    },
    setElementText(el, text) {
      el.textContent = text
    },
    insert(el, parent, anchor = null) {
      parent.insertBefore(el, anchor)
    },
    patchProps(el, key, preValue, nextValue) {
      if(key === 'class') {
        el.className = nextValue || ''
      } else if(shouldSetAsProps(el, key, nextValue)) {
        const type = typeof el[key]

        if(type === 'boolean' && nextValue === '') {
          el[key] = true
        } else {
          el[key] = nextValue
        }
      } else {
        el.setAttribute(key, nextValue)
      }
    }
  })
  // 调用render函数渲染该vnode
  renderer.render(vnode, document.querySelector('#app'))



</script>